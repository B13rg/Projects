<!DOCTYPE html>
<html>
	<head>
		<title>WebSocket demo</title>
	</head>
	<body>
		<script>
			var ws = new WebSocket("ws://127.0.0.1:5678/"),
					messages = document.createElement('ul');
			ws.onmessage = function (event) {
					document.getElementById('dump').innerText=event.data
					var updateData = JSON.parse(event.data);
					setMatchData(updateData);
					setRoundData(updateData);
					//setPlayerData(updateData);
					document.getElementById('position').innerText = inputData['playerItem'].position;
			};

			function setMatchData(inputData){
				updateData = inputData['matchItem'];
				document.getElementById('mode').innerHTML = updateData.mode;
				document.getElementById('mapName').innerText = updateData.map_name;
				document.getElementById('phase').innerHTML = updateData.phase;
				document.getElementById('scoreCT').innerHTML = updateData.score_ct;
				document.getElementById('scoreT').innerHTML = updateData.score_t;
				document.getElementById('timestamp').innerHTML = updateData.timestamp;
			}

			function setRoundData(inputData){
				updateData = inputData['roundItem'];
				document.getElementById('roundNum').innerHTML = updateData.roundNum;
				document.getElementById('phase').innerHTML = updateData.phase;
				document.getElementById('phaseTime').innerHTML = updateData.phaseTime;
			}

			function setPlayerData(inputData){
				updateData = inputData['playerItem'];
				document.getElementById('team').innerHTML = updateData.team;
				document.getElementById('name').innerHTML = updateData.name;

				document.getElementById('kills').innerHTML = updateData.kills;
				document.getElementById('assists').innerHTML = updateData.assists;
				document.getElementById('deaths').innerHTML = updateData.deaths;
				document.getElementById('mvps').innerHTML = updateData.mvps;
				document.getElementById('score').innerHTML = updateData.score;
				
				document.getElementById('health').innerHTML = updateData.health;
				document.getElementById('armor').innerHTML = updateData.armor;
				document.getElementById('helmet').innerHTML = updateData.helmet;
				document.getElementById('money').innerHTML = updateData.money;
				document.getElementById('round_kills').innerHTML = updateData.round_kills;
				document.getElementById('round_killhs').innerHTML = updateData.round_killhs;
				document.getElementById('round_totaldmg').innerHTML = updateData.round_totaldmg;
				document.getElementById('equip_value').innerHTML = updateData.equip_value;
				document.getElementById('position').innerHTML = updateData.position;
			}

			window.onbeforeunload = function() {
				websocket.onclose = function () {}; // disable onclose handler first
				websocket.close();
			};
		</script>

<table id="score">
	<tr>
		<th>CT</th>
		<th>T</th>
	</tr>
	<tr>
		<th id="scoreCT"></th>
		<th id="scoreT"></th>
	</tr>
</table>

<h3>Player Data</h3>
<table id="matchData">
	<tr>
		<th>Team</th>
		<td>Name</td>
		<td>Kills</td>
		<td>Assists</td>
		<td>Deaths</td>
		<td>MVPs</td>
		<td>Score</td>
	</tr>
	<tr>
		<th id="team">0</th>
		<td id="name">0</td>
		<td id="kills">0</td>
		<td id="assists">0</td>
		<td id="deaths">0</td>
		<td id="mvps">0</td>
		<td id="score">0</td>
	</tr>
</table>
<table>
	<tr>
		<td>Health</td>
		<td id="health">0</td>
	</tr>
	<tr>
		<td>Armor</td>
		<td id="armor">0</td>
	</tr>
	<tr>
		<td>Helmet</td>
		<td id="helmet">0</td>
	</tr>
	<tr>
		<td>Money</td>
		<td id="money">0</td>
	</tr>
	<tr>
		<td>Rnd. Kills</td>
		<td id="round_kills">0</td>
	</tr>
	<tr>
		<td>Rnd. HS Kills</td>
		<td id="round_killhs">0</td>
	</tr>
	<tr>
		<td>Rnd. Damage</td>
		<td id="round_totaldmg">0</td>
	</tr>
	<tr>
		<td>Equipment Value</td>
		<td id="equip_value">0</td>
	</tr>
	<tr>
		<td>Position</td>
		<td id="position">0</td>
	</tr>
</table>

<h3>Round Data</h3>
<table id="matchData">
	<tr>
		<th>Round Number</th>
		<th id="roundNum">0</th>
	</tr>
	<tr>
		<td>Phase</td>
		<td id="phase">0</td>
	</tr>
	<tr>
		<td>Phase Time Left</td>
		<td id="phaseTime">0</td>
	</tr>
</table>

<h3>Match Data</h3>
<table id="matchData">
	<tr>
		<th>Mode</th>
		<th id="mode">0</th>
	</tr>
	<tr>
		<td>Map Name</td>
		<td id="mapName">0</td>
	</tr>
	<tr>
		<td>Phase</td>
		<td id="phase">0</td>
	</tr>
	<tr>
		<td>Timestamp</td>
		<td id="timestamp">0</td>
	</tr>
</table>

<div id="dump"></div>

	</body>
</html>